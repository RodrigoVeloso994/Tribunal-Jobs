<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro Cliente</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styleCadClientey.css') }}">
    <script src="https://kit.fontawesome.com/4665b3a379.js" crossorigin="anonymous"></script>
    <link rel="icon" href="{{ url_for('static', filename='images/Logo.png') }}" type="image/png">
    

</head>
<body>

    <div class="loader-overlay">
        <div class="spinner">
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
        </div>
        </div>
    </div>
    <nav class="sidebar">
        <section class="profile-section">
          <img src="{{ session['user_info']['image_url'] }}" alt="Profile picture" class="profile-imagee">
          <h1 class="profile-name">{{ session['user_info']['name'] }}</h1>
          <p class="profile-role">{{ session['user_info']['role'] }}</p>  
        </section>
        
        <ul class="nav-list">
            <li class="nav-item">
                <a href="/Home" class="nav-link">
                    <img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets/TEMP/947e818bbd7d3172fdcb33b91acf0924d8972caabaf15a72f82cccb9ea840bd2?apiKey=86836f072c124e818bc78d0c65f8ba52&" class="nav-icon" alt="">
                    <span class="nav-text">Home</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="/CadastroAdvogado" class="nav-link">
                    <img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets/TEMP/a029aaf80babb69667b5c7121d25929da1e115a7ea30ca07227da4f377e0da37?apiKey=86836f072c124e818bc78d0c65f8ba52&" class="nav-icon" alt="">
                    <span class="nav-text">Cadastrar advogados</span>
                </a>
            </li>
            <li class="nav-item active">
                <a href="/CadastroCliente" class="nav-link">
                    <img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets/TEMP/7cc6f667946bdb2513a1c753f41657bd3a4ea803204f0230fa4c72ffa83ae771?apiKey=86836f072c124e818bc78d0c65f8ba52&" class="nav-icon" alt="">
                    <span class="nav-text">Cadastrar clientes</span>
                </a>
            </li>
            <li class="nav-item ">
              <a href="/GerenciaAdv" class="nav-link">
                  <img loading="lazy" style="  aspect-ratio: 1;
      object-fit: contain;
      object-position: center;
      width: 24px;" src="https://cdn.builder.io/api/v1/image/assets/86836f072c124e818bc78d0c65f8ba52/11df733341c359f742bac4648f1ad0d7ee546521e8b5222a1749a7bc085f46bf?apiKey=86836f072c124e818bc78d0c65f8ba52&" class="nav-icon" alt="">
                  <span class="nav-text">Gerenciar Advogados</span>
              </a>
          </li>
            <li class="nav-item">
                <a href="/TJHome" class="nav-link">
                    <img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets/TEMP/427518cf73675b8be74ce61d6e429be5ed44d054aaa5e124681e454754e014f1?apiKey=86836f072c124e818bc78d0c65f8ba52&" class="nav-icon" alt="">
                    <span class="nav-text">Gerenciar Clientes</span>
                </a>
            </li>
            </li>
            <li class="nav-item">
                <a href="/TJDuvidas" class="nav-link">
                    <img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets/TEMP/0884257241e3b1574843327c16f5e9f08fa07f44942f09efdbcacd72202ad44e?apiKey=86836f072c124e818bc78d0c65f8ba52&" class="nav-icon" alt="">
                    <span class="nav-text">TJ para dúvidas</span>
                </a>
            </li>
        </ul>
        <a href="{{ url_for('logout') }}" class="Btn">
            <div class="sign">
                <svg viewBox="0 0 512 512"><path d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"></path></svg>
            </div>
            <div class="text">Logout</div>
        </a>
    </nav>

    <!-- Área Principal com o Formulário Centralizado -->
    
    <main class="main-content">
        <h1 class="main-title">Cadastro de Cliente</h1>
        {% if msg %}
        <script>
            alert("{{ msg }}");
        </script>
        {% endif %}
                
        <img src="{{ url_for('static', filename='images/Textura inferior.png') }}" class="texturaB">
        <img src="{{ url_for('static', filename='images/Textura superior.png') }}" class="texturaC">
        
        <section class="lawyer-registration">
          <form class="registration-form" method="POST" action="{{ url_for('CadastroCliente') }}" enctype="multipart/form-data">            <!-- Componente de Upload de Imagem (Quadrado e Centralizado) -->
           <!-- Imagem de Upload -->
        <div class="input-div" onclick="triggerUpload()">
            <input class="input" id="upload-input" type="file" name="file" accept=".jpg, .jpeg, .png" onchange="loadFile(event)">
            <img src="https://via.placeholder.com/100" alt="Imagem de perfil" class="profile-pic" id="profile-pic" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" stroke-linejoin="round" stroke-linecap="round" viewBox="0 0 24 24" stroke-width="2" fill="none" stroke="currentColor" class="icon">
              <polyline points="16 16 12 12 8 16"></polyline>
              <line y2="21" x2="12" y1="12" x1="12"></line>
              <path d="M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"></path>
              <polyline points="16 16 12 12 8 16"></polyline>
            </svg>
          </div>
          
          <!-- Primeira Coluna de Campos -->
          <div class="form-column">
            <div class="form-field">
                <input type="text" id="name" name="nome" class="form-input" required>
                <label for="name" class="user-label">Nome</label>
                <small class="error-message" id="name-error"></small>
            </div>
        
            <div class="form-field">
                <input type="email" id="email" name="email" class="form-input" required>
                <label for="email" class="user-label">E-mail</label>
                <small class="error-message" id="email-error"></small>
            </div>
        
            <div class="form-field">
                <input type="date" id="dtNascimento" name="dtNascimento" class="form-input" required>
                <label for="dtNascimento" class="user-label">Data de nascimento</label>
                <small class="error-message" id="dtNascimento-error"></small>
            </div>
        
            <div class="form-field">
                <input id="causa" name="causa" class="form-input" required>
                <label for="causa" class="user-label">Causa</label>
                <small class="error-message" id="causa-error"></small>
            </div>
        </div>
        
        <div class="form-column" style="margin-top:10px">
            <div class="form-field">
                <input type="text" id="cpf" name="cpf" class="form-input" required>
                <label for="cpf" class="user-label">CPF</label>
                <small class="error-message" id="cpf-error"></small>
            </div>
        
            <div class="form-field">
                <input type="text" id="IdAdv" style=" border-color: #4caf50;" name="IdAdv" class="form-input" value="{{ cpfAdv }}" {% if not cpf_editable %}readonly{% endif %} >
                <label for="IdAdv" class="user-label">CPF Advogado</label>
                <small class="error-message" id="IdAdv-error"></small>
            </div>
        
            <div class="form-field">
                <input type="tel" id="fone" name="fone" class="form-input" required>
                <label for="fone" class="user-label">Telefone</label>
                <small class="error-message" id="fone-error"></small>
            </div>
        
            <div class="form-field">
              <textarea id="descricaoCausa" name="descricaoCausa" class="form-input" required  placeholder=" ">{{ cliente.descricaoCausa if cliente else '' }}</textarea>
              <label for="descricaoCausa" class="user-label">Descrição da causa</label>
              <small class="error-message" id="descricaoCausa-error"></small>
          </div>
          

          
        </div>
          
          <!-- Botão de Salvar -->
          <div class="button-container">
            <button type="submit"class="animated-button">
              <svg viewBox="0 0 24 24" class="arr-2" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.58L9 16.17Z"
                ></path>
              </svg>
              <span class="textt">Cadastrar</span>
              <span class="circle"></span>
              <svg viewBox="0 0 24 24" class="arr-1" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.58L9 16.17Z"
                ></path>
              </svg>
            </button>
          </div>
        </form>
      </section>
    </main>
    
    <script>

        window.addEventListener('load', function() {
            document.querySelector('.loader-overlay').style.display = 'none';
        });
        function triggerUpload() {
            document.getElementById("upload-input").click();
          }
          
          function loadFile(event) {
            const output = document.getElementById("profile-pic");
            const uploadIcon = document.querySelector(".icon");
          
            output.src = URL.createObjectURL(event.target.files[0]);
            output.style.display = "block"; // Exibe a imagem de perfil
            uploadIcon.style.display = "none"; // Esconde o ícone de upload
          
            output.onload = () => {
              URL.revokeObjectURL(output.src); // Libera a memória do objeto URL
            };
          }
          
        function togglePasswordVisibility() {
            const passwordField = document.getElementById("password");
            const passwordToggle = document.querySelector(".password-toggle");
          
            if (passwordField.type === "password") {
              passwordField.type = "text";
              passwordToggle.src = "https://cdn.builder.io/api/v1/image/assets/86836f072c124e818bc78d0c65f8ba52/a33e3eec52e9f3d4e6b97b40c2baccf04f5f9f0c1c1c18f3ec438d7cce29509a?apiKey=86836f072c124e818bc78d0c65f8ba52&"; // Ícone para "mostrar"
            } else {
              passwordField.type = "password";
              passwordToggle.src = "https://cdn.builder.io/api/v1/image/assets/86836f072c124e818bc78d0c65f8ba52/da00e5ac0e51b2733793730dccddd40cf2fc37a43ec98e24357ca41487d6f128?apiKey=86836f072c124e818bc78d0c65f8ba52&"; // Ícone para "esconder"
            }
          }


          // Campos de entrada
const inputs = {
  nome: document.getElementById('name'),
  email: document.getElementById('email'),
  dtNascimento: document.getElementById('dtNascimento'),
  causa: document.getElementById('causa'),
  cpf: document.getElementById('cpf'),
  IdAdv: document.getElementById('IdAdv'),
  fone: document.getElementById('fone'),
  descricaoCausa: document.getElementById('descricaoCausa'),
};

// Mensagens de erro
const errors = {
  nome: document.getElementById('name-error'),
  email: document.getElementById('email-error'),
  dtNascimento: document.getElementById('dtNascimento-error'),
  causa: document.getElementById('causa-error'),
  cpf: document.getElementById('cpf-error'),
  IdAdv: document.getElementById('IdAdv-error'),
  fone: document.getElementById('fone-error'),
  descricaoCausa: document.getElementById('descricaoCausa-error'),
};

// Validações específicas para cada campo
function validateField(input, errorElement, validationFn, errorMessage) {
  const value = input.value.trim();
  if (!validationFn(value)) {
      input.classList.add('invalid');
      input.classList.remove('valid');
      errorElement.textContent = errorMessage;
      errorElement.classList.add('active');
  } else {
      input.classList.add('valid');
      input.classList.remove('invalid');
      errorElement.textContent = '';
      errorElement.classList.remove('active');
  }
}



// Máscara e validações para CPF, E-mail e Telefone
inputs.cpf.addEventListener('input', () => {
  inputs.cpf.value = formatCPF(inputs.cpf.value);
  validateField(inputs.cpf, errors.cpf, isValidCPF, 'CPF inválido!');
});

inputs.fone.addEventListener('input', () => {
  inputs.fone.value = formatPhone(inputs.fone.value);
  validateField(inputs.fone, errors.fone, isValidPhone, 'Telefone inválido!');
});

inputs.email.addEventListener('input', () => {
  validateField(inputs.email, errors.email, isValidEmail, 'E-mail inválido!');
});

// Funções auxiliares de validação e máscara
function formatCPF(value) {
  return value.replace(/\D/g, '').replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4').substring(0, 14);
}

function formatPhone(value) {
  return value.replace(/\D/g, '').replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3').substring(0, 15);
}

function isValidCPF(cpf) {
  return cpf.length === 14; // Validação simplificada
}

function isValidPhone(phone) {
  return phone.length === 15; // Validação simplificada
}

function isValidEmail(email) {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(email);
}
// Função para fechar o popup
function closePopup() {
  const popup = document.getElementById('popup-message');
  popup.classList.add('hidden');

  // Remove o elemento do DOM após a animação
  setTimeout(() => {
      popup.remove();
  }, 300);
}

// Fechar automaticamente após 5 segundos
window.addEventListener('DOMContentLoaded', () => {
  const popup = document.getElementById('popup-message');
  if (popup) {
      setTimeout(() => {
          closePopup();
      }, 5000); // 5000ms = 5 segundos
  }
});

          
    </script>
</body>
</html>
